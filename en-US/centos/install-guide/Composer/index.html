<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Custom System Images with Composer :: CentOS Docs Site</title>
    <link rel="canonical" href="https://docs.centos.org/centos/install-guide/Composer/">
    <meta name="generator" content="Antora 1.0.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.centos.org"><img src="https://docs.centos.org/_images/logo_small.png"></a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.centos.org/download/">Download CentOS</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="centos" data-version="master">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../">Installation Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started/">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../downloading/">Downloading CentOS</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Making_Media/">Preparing Installation Media</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Making_Media_Optical/">CD or DVD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Making_Media_USB/">USB Drive</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Making_Media_USB_Linux/">Making an Installation USB Drive on Linux</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Making_Media_USB_Windows/">Making an Installation USB Drive on Windows</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Making_Media_USB_Mac/">Making an Installation USB Drive on Mac</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Preparing_Install_Sources/">Preparing Installation Sources</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Install_Source_DVD/">Installation Source on a DVD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Install_Source_HDD/">Installation Source on a Hard Drive</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Install_Source_Network/">Installation Source on the Network</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Part_Install_x86/">Installing on x86_64 and ARM 64</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Simple_Installation/">Quick Installation Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Steps-x86/">Planning for Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DU-Updating_drivers_during_installation_x86/">Updating Drivers During Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Boot_x86/">Booting the Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Graphical_Installation-x86/">Installing Using Anaconda</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Consoles_Logs_During_Install_x86/">Consoles and Logging During the Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Text_Installation_Intro-x86/">Installing in Text Mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Graphical_Installation_Intro-x86/">Installing in the Graphical User Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../WelcomeSpoke-x86/">Welcome Screen and Language Selection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SummaryHub-x86/">The Installation Summary Screen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../DateTimeSpoke-x86/">Date &amp; Time</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../LangSupportSpoke-x86/">Language Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../KeyboardSpoke-x86/">Keyboard Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SecurityPolicySpoke-x86/">Security Policy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SourceSpoke-x86/">Installation Source</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../NetworkSpoke-x86/">Network &amp; Hostname</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SoftwareSpoke-x86/">Software Selection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../StorageSpoke-x86/">Installation Destination</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomSpoke-x86/">Manual Partitioning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../FilterSpoke-x86/">Storage Devices</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../KdumpSpoke-x86/">Kdump</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Write_changes_to_disk_x86/">Begin Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ProgressHub-x86/">Installation Progress</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PasswordSpoke-x86/">Set the Root Password</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../UserSpoke-x86/">Create a User Account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Complete-x86/">Installation Complete</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Trouble-x86/">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Part_Install_ppc/">Installing on IBM Power Systems</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Steps-ppc/">Planning for Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DU-Updating_drivers_during_installation_ppc/">Updating Drivers During Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Boot_ppc/">Booting the Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Graphical_Installation-ppc/">Installing Using Anaconda</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Consoles_Logs_During_Install_ppc/">Consoles and Logging During the Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Text_Installation_Intro-ppc/">Installing in Text Mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Graphical_Installation_Intro-ppc/">Installing in the Graphical User Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../WelcomeSpoke-ppc64/">Welcome Screen and Language Selection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SummaryHub-ppc64/">The Installation Summary Screen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../DateTimeSpoke-ppc64/">Date &amp; Time</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../LangSupportSpoke-ppc64/">Language Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../KeyboardSpoke-ppc64/">Keyboard Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SecurityPolicySpoke-ppc64/">Security Policy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SourceSpoke-ppc64/">Installation Source</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../NetworkSpoke-ppc64/">Network &amp; Hostname</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../SoftwareSpoke-ppc64/">Software Selection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../StorageSpoke-ppc64/">Installation Destination</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomSpoke-ppc64/">Manual Partitioning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../FilterSpoke-ppc64/">Storage Devices</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../KdumpSpoke-ppc64/">Kdump</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Write_changes_to_disk_ppc/">Begin Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ProgressHub-ppc64/">Installation Progress</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PasswordSpoke-ppc64/">Set the Root Password</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../UserSpoke-ppc64/">Create a User Account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Complete-ppc/">Installation Complete</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Trouble-ppc/">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Part_Install_Advanced/">Advanced Installation Options</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../adminoptions/">Boot Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pxe-server/">Preparing for a Network Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vnc-installations/">Using VNC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../headless-installations/">Headless Systems</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kickstart2/">Kickstart Installations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../disk-image-install/">Installing into a Disk Image</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Building Custom System Images with Composer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Part_After_Install/">After Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../InitialSetupHub-common/">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nextsteps/">Your Next Steps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Rescue_Mode/">Basic System Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../uninstall/">Uninstalling CentOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Part_Appendixes/">Technical Appendixes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Partitions-x86/">An Introduction to Disk Partitions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../iSCSI/">iSCSI Disks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Understanding_LVM/">Understanding LVM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../techref/">Other Technical Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ext4_to_xfs_command_reference_table/">Reference Table for ext4 and XFS Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data_size_appendix/">Data Size Terminology Reference Table</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Revision_History/">Revision History</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Installation Guide</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">CentOS Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../docs/">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Installation Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../../docs/" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../">Installation Guide</a></li>
    <li class="crumb"><a href="../Part_Install_Advanced/">Advanced Installation Options</a></li>
    <li class="crumb"><a href="./">Building Custom System Images with Composer</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/CentOS/docs-installation-guide/edit/7.6/modules/install-guide/pages/Composer.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Building Custom System Images with Composer</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction_to_composer">Introduction to Composer</a></li>
<li><a href="#_composer_system_requirements">Composer System Requirements</a></li>
<li><a href="#_preparing-a-repository-mirror-for-composer">Preparing a Repository Mirror for Composer</a></li>
<li><a href="#_installing_composer">Installing Composer</a></li>
<li><a href="#_accessing_composer_gui_in_web_console">Accessing Composer GUI in Cockpit</a></li>
<li><a href="#_creating_a_composer_blueprint">Creating a Composer Blueprint</a></li>
<li><a href="#_editing_a_composer_blueprint">Editing a Composer Blueprint</a></li>
<li><a href="#_creating_a_system_image_with_composer">Creating a System Image with Composer</a></li>
<li><a href="#composer-additional-resources">Additional Resources</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Composer is a tool for creating custom system images. The following sections describe how to install it and how to use it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_composer"><a class="anchor" href="#_introduction_to_composer"></a>Introduction to Composer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Composer is a tool that enables users to create customized system images of CentOS. On CentOS&#160;7.6.1810, Composer is available in the <strong class="package">lorax-composer</strong> package.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_composer_output_formats" class="discrete">Composer Output Formats</h3>
<div class="paragraph">
<p>Composer can create these output formats:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">CLI name</th>
<th class="tableblock halign-left valign-top">file extension</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QEMU QCOW2 Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qcow2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.qcow2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ext4 File System Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext4-filesystem</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.img</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw Partitioned Disk Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>partitioned-disk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.img</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Live Bootable ISO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>live-iso</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.iso</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TAR Archive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.tar</code></p></td>
</tr>
</tbody>
</table>
<h3 id="_composer_user_interfaces" class="discrete">Composer User Interfaces</h3>
<div class="paragraph">
<p>The Composer back end runs as a system service <code class="command">lorax-composer</code>. Users can interact with this service through two front ends:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GUI available as a Cockpit plugin. This is the preferred method.</p>
</li>
<li>
<p>CLI available as the <code class="command">composer-cli</code> tool for running commands.</p>
</li>
</ul>
</div>
<h3 id="_composer_blueprints" class="discrete">Composer Blueprints</h3>
<div class="paragraph">
<p>In Composer, a <em>blueprint</em> defines a customized system image by listing packages that will be part of the system. Blueprints can be edited and they are versioned.</p>
</div>
<div class="paragraph">
<p>When a system image is created from a blueprint, the image is associated with the blueprint in Composer Cockpit interface.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_composer_system_requirements"><a class="anchor" href="#_composer_system_requirements"></a>Composer System Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use a virtual machine to run Composer, because the underlying <code class="command">lorax</code> tool performs a number of potentially insecure and unsafe actions while creating the system images. The environment where Composer runs should meet these requirements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Minimal Required Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A dedicated virtual machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 cores</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 GiB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disk space</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 GiB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access privileges</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administrator level (root)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SElinux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Off (permissive mode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connectivity to Internet and to a system with repository mirrors</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Apart from the virtual machine that runs Composer itself, another system is needed to provide mirrors of Red Hat content delivery network (CDN) package repositories.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preparing-a-repository-mirror-for-composer"><a class="anchor" href="#_preparing-a-repository-mirror-for-composer"></a>Preparing a Repository Mirror for Composer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For technical reasons, Composer cannot directly use the Red Hat content delivery network (CDN). This procedure describes how to prepare a mirror of such content on a system different from the one running Composer.</p>
</div>
<h3 id="_prerequisites" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>The file system containing the <code>/var/www</code> directory must have at least 50 GiB of free space available. To check this:</p>
<div class="literalblock">
<div class="content">
<pre>$ <code class="command">df -h /var/www/</code></pre>
</div>
</div>
</li>
<li>
<p>The system must use the same version of Red Hat Enterprise Linux as the system using Composer and be fully subscribed.</p>
</li>
</ul>
</div>
<h3 id="_procedure" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the tools for handling packages and repositories, and the Apache web server:</p>
<div class="literalblock">
<div class="content">
<pre># yum install yum-utils createrepo httpd</pre>
</div>
</div>
</li>
<li>
<p>List the repositories enabled on this machine and note their identifiers:</p>
<div class="literalblock">
<div class="content">
<pre># yum repolist</pre>
</div>
</div>
</li>
<li>
<p>Create local mirrors of the repositories that you want to use in Composer. For each of these repositories, run:</p>
<div class="literalblock">
<div class="content">
<pre># mkdir -p /var/www/html
# reposync --gpgcheck -l --download_path=/var/www/html --repoid REPO-ID --downloadcomps --download-metadata
$ cd /var/www/html/REPO-ID
$ createrepo -v /var/www/html/REPO-ID -g comps.xml</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <em>REPO-ID</em> with the identifier you noted in the previous step.</p>
</div>
</li>
<li>
<p>Make sure that the repositories have the correct SELinux context so that the <code class="command">httpd</code> Apache web server can access the repository mirrors:</p>
<div class="literalblock">
<div class="content">
<pre># chcon -vR -t httpd_sys_content_t /var/www/html/</pre>
</div>
</div>
</li>
<li>
<p>Enable the web server to start after each reboot, configure the system firewall, and start the server for the first time:</p>
<div class="literalblock">
<div class="content">
<pre># systemctl enable httpd
# firewall-cmd --add-service=http --permanent
# firewall-cmd --add-service=http
# systemctl start httpd</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_composer"><a class="anchor" href="#_installing_composer"></a>Installing Composer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install Composer on a dedicated virtual machine, follow these steps.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_prerequisites_2" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>The virtual machine for Composer must be already installed, meet the <a href="#_composer_system_requirements">requirements</a>, be subscribed, and be running.</p>
</li>
<li>
<p>The <a href="#_preparing-a-repository-mirror-for-composer">system with repository mirrors</a> must be accessible on network.</p>
</li>
<li>
<p>The Composer system must use the same version of CentOS as the system containing repository mirrors.</p>
</li>
<li>
<p>You must be connected to the virtual machine and run all the commands there.</p>
</li>
<li>
<p>The repository <code>RHEL-7-Extras</code> must be enabled on the system.</p>
</li>
</ul>
</div>
<h3 id="_procedure_2" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the Composer packages:</p>
<div class="literalblock">
<div class="content">
<pre># yum install lorax-composer composer-cli cockpit-composer</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If Cockpit is not installed yet, it is implicitly installed as a dependency of the <strong class="package">cockpit-composer</strong> package.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>List the repositories enabled on this machine and note their identifiers:</p>
<div class="literalblock">
<div class="content">
<pre># yum repolist</pre>
</div>
</div>
</li>
<li>
<p>Create a repository configuration file in the <code>/etc/yum.repos.d</code> directory which points to the mirrored repositories. Include the IP address or host name of the virtual machine system. For each of the repository mirrors, run:</p>
<div class="literalblock">
<div class="content">
<pre># cat &gt;&gt; /etc/yum.repos.d/mirror.repo &lt;&lt;EOF
[mirror-<em>REPO-ID</em>]
name=<em>NAME</em>
baseurl=http://<em>IP-ADDR</em>/cdrom/
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release

EOF</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <em>REPO-ID</em> with the repository identifier, <em>NAME</em> with the repository name, and <em>IP-ADDR</em> with the IP address or host name. This will present the repository mirrors to the system with an identifier containing the prefix <em>mirror-</em>.</p>
</div>
</li>
<li>
<p>Verify the repository configuration:</p>
<div class="literalblock">
<div class="content">
<pre># yum clean all
# yum repolist</pre>
</div>
</div>
</li>
<li>
<p>Disable the original subscribed repositories from Red Hat content delivery network. For each of the mirrored repositories, run:</p>
<div class="literalblock">
<div class="content">
<pre># yum-config-manager --disable REPO-ID</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <em>REPO-ID</em> with the repository identifier.</p>
</div>
</li>
<li>
<p>Enable Composer to start after each reboot and configure the system firewall:</p>
<div class="literalblock">
<div class="content">
<pre># systemctl enable lorax-composer.socket
# systemctl enable cockpit.socket
# firewall-cmd --add-service=cockpit &amp;&amp; firewall-cmd --add-service=cockpit --permanent</pre>
</div>
</div>
</li>
<li>
<p>The Composer and Cockpit services are started automatically on each system reboot. For this first session after installation, start these services manually:</p>
<div class="literalblock">
<div class="content">
<pre># systemctl start lorax-composer
# systemctl start cockpit</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_accessing_composer_gui_in_web_console"><a class="anchor" href="#_accessing_composer_gui_in_web_console"></a>Accessing Composer GUI in Cockpit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using Cockpit is the recommended way of accessing Composer functionality.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_prerequisites_3" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>You must have root access to the system.</p>
</li>
</ul>
</div>
<h3 id="_procedure_3" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <code><a href="https://localhost:9090/"><a href="https://localhost:9090/" class="bare">https://localhost:9090/</a></a></code> in a web browser on the system with Composer.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Accessing Composer from another system falls under the topic of remote access to Cockpit. For more information, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/getting_started_with_cockpit/index">Getting Started with Cockpit</a> guide.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Log into the Cockpit with credentials for an user account with sufficient privileges on the system.</p>
</li>
<li>
<p>On the left, click the <code>Image Builder</code> icon to display the Composer controls.</p>
<div class="paragraph">
<p>The Composer view opens, listing existing blueprints.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_composer_blueprint"><a class="anchor" href="#_creating_a_composer_blueprint"></a>Creating a Composer Blueprint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These are the steps for creating a blueprint.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_prerequisites_4" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>You have opened the Composer Cockpit interface in a browser.</p>
</li>
</ul>
</div>
<h3 id="_procedure_4" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <b class="button">Create Blueprint</b> in the top right corner.</p>
<div class="paragraph">
<p>A pop-up appears with fields for the blueprint name and description.</p>
</div>
</li>
<li>
<p>Fill in the name of the blueprint and its description, then click <b class="button">Create</b>.</p>
<div class="paragraph">
<p>The screen changes to blueprint editing mode.</p>
</div>
</li>
<li>
<p>Add components that you want to include in the system image:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the left, enter component name or a part of it into the field under the heading <code>Available Components</code> and press <b class="button">Enter</b>.</p>
<div class="paragraph">
<p>The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.</p>
</div>
<div class="paragraph">
<p>If the list of components is too long, add further search terms in the same way.</p>
</div>
</li>
<li>
<p>The list of components is paged. To move to other result pages, use the arrows and entry field above the component list.</p>
</li>
<li>
<p>Click on name of the component you intend to use to display its details. The right pane fills with details of the components, such as its version and dependencies.</p>
</li>
<li>
<p>Select the version you want to use in the <code>Component Options</code> box, with the <code>Version Release</code> drop-down menu.</p>
</li>
<li>
<p>Click <b class="button">Add</b> in the top left.</p>
</li>
<li>
<p>If you added a component by mistake, remove it by clicking the <b class="button">⫶</b> button at the far right of its entry in the right pane, and select <code>Remove</code> in the menu.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not intend to select version for some components, you can skip the component details screen and version selection by clicking the <b class="button">+</b> buttons on the right side of the component list.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>To save the blueprint, click <b class="button">Commit</b> in the top left. A dialog with a summary of the changes pops up. Click <b class="button">Commit</b>.</p>
<div class="paragraph">
<p>A small pop-up on the right informs you of the saving progress and then result.</p>
</div>
</li>
<li>
<p>In the top left, click <code>Back to Blueprints</code> to exit the editing screen.</p>
<div class="paragraph">
<p>The Composer view opens, listing existing blueprints.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_editing_a_composer_blueprint"><a class="anchor" href="#_editing_a_composer_blueprint"></a>Editing a Composer Blueprint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These are the steps for editing a blueprint.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_prerequisites_5" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>You have opened the Composer Cockpit interface in a browser.</p>
</li>
<li>
<p>A blueprint exists.</p>
</li>
</ul>
</div>
<h3 id="_procedure_5" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Locate the blueprint that you want to edit by entering its name or a part of it into the search box at top left, and press <kbd>Enter</kbd>.</p>
<div class="paragraph">
<p>The search is added to the list of filters under the text entry field, and the list of blueprints below is reduced to these that match the search.</p>
</div>
<div class="paragraph">
<p>If the list of blueprints is too long, add further search terms in the same way.</p>
</div>
</li>
<li>
<p>On the left side of the blueprint, press the <b class="button">Edit Blueprint</b> button that belongs to the blueprint.</p>
<div class="paragraph">
<p>The view changes to the blueprint editing screen.</p>
</div>
</li>
<li>
<p>Remove unwanted components by clicking their <b class="button">⫶</b> button at the far right of its entry in the right pane, and select <code>Remove</code> in the menu.</p>
</li>
<li>
<p>Change version of existing components:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the left, enter component name or a part of it into the field under the heading <code>Blueprint Components</code> and press <b class="button">Enter</b>.</p>
<div class="paragraph">
<p>The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.</p>
</div>
<div class="paragraph">
<p>If the list of components is too long, add further search terms in the same way.</p>
</div>
</li>
<li>
<p>Click the <b class="button">⫶</b> button at the far right of the component entry, and select <code>Edit</code> in the menu.</p>
<div class="paragraph">
<p>A component details screen opens in the right pane.</p>
</div>
</li>
<li>
<p>Select the required version in the <code>Version Release</code> drop-down menu and click <b class="button">Apply Change</b> in top left.</p>
<div class="paragraph">
<p>The change is saved and the right pane returns to listing the blueprint components.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add new components:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the left, enter component name or a part of it into the field under the heading <code>Available Components</code> and press <b class="button">Enter</b>.</p>
<div class="paragraph">
<p>The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.</p>
</div>
<div class="paragraph">
<p>If the list of components is too long, add further search terms in the same way.</p>
</div>
</li>
<li>
<p>The list of components is paged. To move to other result pages, use the arrows and entry field above the component list.</p>
</li>
<li>
<p>Click on name of the component you intend to use to display its details. The right pane fills with details of the components, such as its version and dependencies.</p>
</li>
<li>
<p>Select the version you want to use in the <code>Component Options</code> box, with the <code>Version Release</code> drop-down menu.</p>
</li>
<li>
<p>Click <b class="button">Add</b> in the top left.</p>
</li>
<li>
<p>If you added a component by mistake, remove it by clicking the <b class="button">⫶</b> button at the far right of its entry in the right pane, and select <code>Remove</code> in the menu.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not intend to select version for some components, you can skip the component details screen and version selection by clicking the <b class="button">+</b> buttons on the right side of the component list.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Commit a new version of the blueprint with your changes:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <b class="button">Commit</b> button in top left.</p>
<div class="paragraph">
<p>A pop-up window with a summary of your changes appears.</p>
</div>
</li>
<li>
<p>Review your changes and confirm them by clicking <b class="button">Commit</b>.</p>
<div class="paragraph">
<p>A small pop-up on the right informs you of the saving progress and then result. A new version of the blueprint is created.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>In the top left, click <code>Back to Blueprints</code> to exit the editing screen.</p>
<div class="paragraph">
<p>The Composer view opens, listing existing blueprints.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_system_image_with_composer"><a class="anchor" href="#_creating_a_system_image_with_composer"></a>Creating a System Image with Composer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following steps below describe creating a system image.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Composer is an experimental feature in CentOS&#160;7.6.1810.</p>
</div>
</td>
</tr>
</table>
</div>
<h3 id="_prerequisites_6" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>You have opened the Composer Cockpit interface in a browser.</p>
</li>
<li>
<p>A blueprint exists.</p>
</li>
</ul>
</div>
<h3 id="_procedure_6" class="discrete">Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Locate the blueprint that you want to edit by entering its name or a part of it into the search box at top left, and press <kbd>Enter</kbd>.</p>
<div class="paragraph">
<p>The search is added to the list of filters under the text entry field, and the list of blueprints below is reduced to these that match the search.</p>
</div>
<div class="paragraph">
<p>If the list of blueprints is too long, add further search terms in the same way.</p>
</div>
</li>
<li>
<p>On the left side of the blueprint, press the <b class="button">Create Image</b> button that belongs to the blueprint.</p>
<div class="paragraph">
<p>A pop-up window appears.</p>
</div>
</li>
<li>
<p>Select the image type and architecture and press <b class="button">Create</b>.</p>
<div class="paragraph">
<p>A small pop-up in the top left informs you that the image creation has been added to the queue.</p>
</div>
</li>
<li>
<p>Click the name of the blueprint.</p>
<div class="paragraph">
<p>A screen with details of the blueprint opens.</p>
</div>
</li>
<li>
<p>Click the <code>Images</code> tab to switch to it.</p>
</li>
<li>
<p>The image that is being created is listed with the status <code>Pending</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Image creation takes a longer time, measured in minutes. There is no indication of progress while the image is created.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To abort image creation, press its <b class="button">Stop</b> button on the right.</p>
</div>
</li>
<li>
<p>Once the image is successfully created, the <b class="button">Stop</b> button is replaced by a <b class="button">Download</b> button. Click this button to download the image to your system.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="composer-additional-resources"><a class="anchor" href="#composer-additional-resources"></a>Additional Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Upstream Weldr documentation: <a href="https://weldr.io/"><a href="https://weldr.io/" class="bare">https://weldr.io/</a></a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
